
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>diffraction Module &#8212; scikit-beam 0.0.14 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="fluorescence Module" href="fluorescence.html" />
    <link rel="prev" title="core.mask Module" href="core/mask.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-skbeam.diffraction">
<span id="diffraction-module"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">diffraction</span></code> Module<a class="headerlink" href="#module-skbeam.diffraction" title="Permalink to this headline">¶</a></h1>
<p>This module creates a namespace for X-Ray Diffraction</p>
<dl class="class">
<dt id="skbeam.diffraction.BasicElement">
<em class="property">class </em><code class="descclassname">skbeam.diffraction.</code><code class="descname">BasicElement</code><span class="sig-paren">(</span><em>Z</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.BasicElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.5/library/functions.html#object" title="(in Python v3.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Object to return basic elemental information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>element</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str or int</span></dt>
<dd><p class="first last">Element symbol, name or atomic number (‘Zinc’, ‘Zn’ or 30)</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create an `Element` object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;Zn&#39;</span><span class="p">)</span> <span class="c1"># or e = Element(30)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get the atomic mass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">mass</span>
<span class="go">65.37</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get the density in grams / cm^3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">density</span>
<span class="go">7.14</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Z</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Atomic number</p>
</dd>
<dt><strong>sym</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Element symbol (Fe, Cr, etc.)</p>
</dd>
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Full element name (Iron, Chromium, etc.</p>
</dd>
<dt><strong>atomic_radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">AtomicRadius[A]</p>
</dd>
<dt><strong>covalent_radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">CovalentRadius[A]</p>
</dd>
<dt><strong>mass</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">AtomicMass</p>
</dd>
<dt><strong>bp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">BoilingPoint[K]</p>
</dd>
<dt><strong>mp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">MeltingPoint[K]</p>
</dd>
<dt><strong>density</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Density[g/ccm]</p>
</dd>
<dt><strong>atomic_volume</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">AtomicVolume</p>
</dd>
<dt><strong>coherent_scattering_length</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">CoherentScatteringLength[1E-12cm]</p>
</dd>
<dt><strong>incoherent_crosssection</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">IncoherentX-section[barn]</p>
</dd>
<dt><strong>absorption</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Absorption&#64;1.8A[barn]</p>
</dd>
<dt><strong>debye_temp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">DebyeTemperature[K]</p>
</dd>
<dt><strong>thermal_conductivity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">ThermalConductivity[W/cmK]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="skbeam.diffraction.Lorentzian2Model">
<em class="property">class </em><code class="descclassname">skbeam.diffraction.</code><code class="descname">Lorentzian2Model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.Lorentzian2Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></p>
<p>Wrap the lorentzian2 function for fitting within lmfit framework
1-d lorentzian squared profile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">independent variable</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of lorentzian squared peak,
If area is set as 1, the integral is unity.</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.gaussian">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">gaussian</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>1 dimensional gaussian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">independent variable</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Area of the normally distributed peak</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.lorentzian">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">lorentzian</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>1 dimensional lorentzian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">independent variable</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of lorentzian peak,
If area is set as 1, the integral is unity.</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.lorentzian2">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">lorentzian2</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.lorentzian2" title="Permalink to this definition">¶</a></dt>
<dd><p>1-d lorentzian squared profile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">independent variable</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of lorentzian squared peak,
If area is set as 1, the integral is unity.</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.voigt">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">voigt</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>gamma=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolution of gaussian and lorentzian curve.</p>
<p>see <a class="reference external" href="http://en.wikipedia.org/wiki/Voigt_profile">http://en.wikipedia.org/wiki/Voigt_profile</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">independent variable</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of voigt peak</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
<dt><strong>gamma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">half width at half maximum of lorentzian.
If optional, <cite>gamma</cite> gets set to <cite>sigma</cite></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.pvoigt">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">pvoigt</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>fraction</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.pvoigt" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear combination  of gaussian and lorentzian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">independent variable</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of pvoigt peak</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
<dt><strong>fraction</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">weight for lorentzian peak in the linear combination, and (1-fraction)
is the weight for gaussian peak.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.gaussian_tail">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">gaussian_tail</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.gaussian_tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a gaussian tail function to simulate compton peak</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">data in x coordinate</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of gauss tail function
If area is set as 1, the integral is unity.</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">control peak width</p>
</dd>
<dt><strong>gamma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">normalization factor</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>counts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">gaussian tail peak</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="rdb934e211b42-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Rene Van Grieken, “Handbook of X-Ray Spectrometry, Second Edition,
(Practical Spectroscopy)”, CRC Press, 2 edition, pp. 182, 2007.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.gausssian_step">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">gausssian_step</code><span class="sig-paren">(</span><em>x</em>, <em>area</em>, <em>center</em>, <em>sigma</em>, <em>peak_e</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.gausssian_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Gauss step function is an important component in modeling compton peak.
Use scipy erfc function. Please note erfc = 1-erf.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">data in x coordinate</p>
</dd>
<dt><strong>area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">area of gauss step function</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">center position</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation</p>
</dd>
<dt><strong>peak_e</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">emission energy</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>counts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">gaussian step peak</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r3e62d7f2e8c8-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>Rene Van Grieken, “Handbook of X-Ray Spectrometry, Second Edition,
(Practical Spectroscopy)”, CRC Press, 2 edition, pp. 182, 2007.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.process_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">process_to_q</code><span class="sig-paren">(</span><em>setting_angles</em>, <em>detector_size</em>, <em>pixel_size</em>, <em>calibrated_center</em>, <em>dist_sample</em>, <em>wavelength</em>, <em>ub</em>, <em>frame_mode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.process_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>This will compute the hkl values for all pixels in a shape specified by
detector_size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>setting_angles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">six angles of all the images - Required shape is [num_images][6] and
required type is something that can be cast to a 2D numpy array
Angle order: delta, theta, chi, phi, mu, gamma (degrees)</p>
</dd>
<dt><strong>detector_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">2 element tuple defining the number of pixels in the detector. Order is
(num_columns, num_rows)</p>
</dd>
<dt><strong>pixel_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">2 element tuple defining the size of each pixel in mm. Order is
(column_pixel_size, row_pixel_size).  If not in mm, must be in the same
units as <cite>dist_sample</cite></p>
</dd>
<dt><strong>calibrated_center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">2 element tuple defining the center of the detector in pixels. Order
is (column_center, row_center)(x y)</p>
</dd>
<dt><strong>dist_sample</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">distance from the sample to the detector (mm). If not in mm, must be
in the same units as <cite>pixel_size</cite></p>
</dd>
<dt><strong>wavelength</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">wavelength of incident radiation (Angstroms)</p>
</dd>
<dt><strong>ub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">UB matrix (orientation matrix) 3x3 matrix</p>
</dd>
<dt><strong>frame_mode</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Frame mode defines the data collection mode and thus the desired
output from this function. Defaults to hkl mode (frame_mode=4)
‘theta’    : Theta axis frame.
‘phi’      : Phi axis frame.
‘cart’     : Crystal cartesian frame.
‘hkl’      : Reciprocal lattice units frame.
See the <cite>process_to_q.frame_mode</cite> attribute for an exact list of
valid options.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>hkl</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">(Qx, Qy, Qz) - HKL values
shape is [num_images * num_rows * num_columns][3]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Six angles of an image: (delta, theta, chi, phi, mu, gamma )
These axes are defined according to the following references.</p>
<p>References: text <a class="reference internal" href="#r3e1c4da2c11d-1" id="id3">[1]</a>, text <a class="reference internal" href="#r3e1c4da2c11d-2" id="id4">[2]</a></p>
<table class="docutils citation" frame="void" id="r3e1c4da2c11d-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>M. Lohmeier and E.Vlieg, “Angle calculations for a six-circle
surface x-ray diffractometer,” J. Appl. Cryst., vol 26, pp 706-716,
1993.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3e1c4da2c11d-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>E. Vlieg, “A (2+3)-Type surface diffractometer: Mergence of the
z-axis and (2+2)-Type geometries,” J. Appl. Cryst., vol 31, pp 198-203,
1998.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.hkl_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">hkl_to_q</code><span class="sig-paren">(</span><em>hkl_arr</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.hkl_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>This module compute the reciprocal space (q) values from known HKL array
for each pixel of the detector for all the images</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>hkl_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">(Qx, Qy, Qz) - HKL array
shape is [num_images * num_rows * num_columns][3]</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q_val</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Reciprocal values for each pixel for all images
shape is [num_images * num_rows * num_columns]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.bin_1D">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">bin_1D</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>nx=None</em>, <em>min_x=None</em>, <em>max_x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.bin_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin the values in y based on their x-coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">position</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">intensity</p>
</dd>
<dt><strong>nx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer, optional</span></dt>
<dd><p class="first last">number of bins to use defaults to default bin value</p>
</dd>
<dt><strong>min_x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Left edge of first bin defaults to minimum value of x</p>
</dd>
<dt><strong>max_x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Right edge of last bin defaults to maximum value of x</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>edges</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">edges of bins, length nx + 1</p>
</dd>
<dt><strong>val</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">sum of values in each bin, length nx</p>
</dd>
<dt><strong>count</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">The number of counts in each bin, length nx</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.bin_edges">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">bin_edges</code><span class="sig-paren">(</span><em>range_min=None</em>, <em>range_max=None</em>, <em>nbins=None</em>, <em>step=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.bin_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate bin edges.  The last value in the returned array is
the right edge of the last bin, the rest of the values are the
left edges of each bin.</p>
<p>If <cite>range_max</cite> is specified all bin edges will be less than or
equal to it’s value.</p>
<p>If <cite>range_min</cite> is specified all bin edges will be greater than
or equal to it’s value</p>
<p>If <cite>nbins</cite> is specified then there will be than number of bins and
the returned array will have length <cite>nbins + 1</cite> (as the right most
edge is included)</p>
<p>If <cite>step</cite> is specified then bin width is approximately <cite>step</cite> (It is
not exact due to the nature of floats). The arrays generated by
<cite>np.cumsum(np.ones(nbins) * step)</cite> and <cite>np.arange(nbins) * step</cite> are
not identical.  This function uses the second method in all cases
where <cite>step</cite> is specified.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the set <code class="code docutils literal notranslate"><span class="pre">(range_min,</span> <span class="pre">range_max,</span> <span class="pre">step)</span></code> is
given there is no guarantee that <code class="code docutils literal notranslate"><span class="pre">range_max</span> <span class="pre">-</span> <span class="pre">range_min</span></code>
is an integer multiple of <code class="code docutils literal notranslate"><span class="pre">step</span></code>.  In this case the left
most bin edge is <code class="code docutils literal notranslate"><span class="pre">range_min</span></code> and the right most bin edge
is less than <code class="code docutils literal notranslate"><span class="pre">range_max</span></code> and the distance between the
right most edge and <code class="code docutils literal notranslate"><span class="pre">range_max</span></code> is not greater than
<code class="code docutils literal notranslate"><span class="pre">step</span></code> (this is the same behavior as the built-in
<code class="code docutils literal notranslate"><span class="pre">range()</span></code>).  It is not recommended to specify bins in this
manner.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>range_min</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The minimum value that may be included as a bin edge</p>
</dd>
<dt><strong>range_max</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The maximum value that may be included as a bin edge</p>
</dd>
<dt><strong>nbins</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">The number of bins, if specified the length of the returned
value will be nbins + 1</p>
</dd>
<dt><strong>step</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The step between the bins</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>edges</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array</span></dt>
<dd><p class="first last">An array of floats for the bin edges.  The last value is the
right edge of the last bin.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.bin_edges_to_centers">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">bin_edges_to_centers</code><span class="sig-paren">(</span><em>input_edges</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.bin_edges_to_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for turning a array of bin edges into
an array of bin centers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>input_edges</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">N + 1 values which are the left edges of N bins
and the right edge of the last bin</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>centers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">A length N array giving the centers of the bins</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.grid3d">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">grid3d</code><span class="sig-paren">(</span><em>q</em>, <em>img_stack</em>, <em>nx=None</em>, <em>ny=None</em>, <em>nz=None</em>, <em>xmin=None</em>, <em>xmax=None</em>, <em>ymin=None</em>, <em>ymax=None</em>, <em>zmin=None</em>, <em>zmax=None</em>, <em>binary_mask=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.grid3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Grid irregularly spaced data points onto a regular grid via histogramming</p>
<p>This function will process the set of reciprocal space values (q), the
image stack (img_stack) and grid the image data based on the bounds
provided, using defaults if none are provided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">(Qx, Qy, Qz) - HKL values - Nx3 array</p>
</dd>
<dt><strong>img_stack</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Intensity array of the images
dimensions are: [num_img][num_rows][num_cols]</p>
</dd>
<dt><strong>nx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of voxels along x</p>
</dd>
<dt><strong>ny</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of voxels along y</p>
</dd>
<dt><strong>nz</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of voxels along z</p>
</dd>
<dt><strong>xmin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Minimum value along x. Defaults to smallest x value in q</p>
</dd>
<dt><strong>ymin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Minimum value along y. Defaults to smallest y value in q</p>
</dd>
<dt><strong>zmin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Minimum value along z. Defaults to smallest z value in q</p>
</dd>
<dt><strong>xmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Maximum value along x. Defaults to largest x value in q</p>
</dd>
<dt><strong>ymax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Maximum value along y. Defaults to largest y value in q</p>
</dd>
<dt><strong>zmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Maximum value along z. Defaults to largest z value in q</p>
</dd>
<dt><strong>binary_mask</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, optional</span></dt>
<dd><p class="first last">The binary mask provides a mechanism to remove unwanted pixels
from the images.
Binary mask can be two different shapes.
- 1: 2-D with binary_mask.shape == np.asarray(img_stack[0]).shape
- 2: 3-D with binary_mask.shape == np.asarray(img_stack).shape</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mean</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">intensity grid.  The values in this grid are the
mean of the values that fill with in the grid.</p>
</dd>
<dt><strong>occupancy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">The number of data points that fell in the grid.</p>
</dd>
<dt><strong>std_err</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">This is the standard error of the value in the
grid box.</p>
</dd>
<dt><strong>bounds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">tuple of (min, max, step) for x, y, z in order: [x_bounds,
y_bounds, z_bounds]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.q_to_d">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">q_to_d</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.q_to_d" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert <span class="math notranslate nohighlight">\(d\)</span> to <span class="math notranslate nohighlight">\(q\)</span>.  The point
of this function is to prevent fat-fingered typos.</p>
<p>By definition the relationship is:</p>
<div class="math notranslate nohighlight">
\[q = \frac{2 \pi}{d}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of q values</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>d</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of d (plane) spacing in the inverse of the units of <code class="docutils literal notranslate"><span class="pre">q</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.d_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">d_to_q</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.d_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert <span class="math notranslate nohighlight">\(d\)</span> to <span class="math notranslate nohighlight">\(q\)</span>.
The point of this function is to prevent fat-fingered typos.</p>
<p>By definition the relationship is:</p>
<div class="math notranslate nohighlight">
\[d = \frac{2 \pi}{q}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>d</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of d (plane) spacing</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of q values in the inverse of the units of <code class="docutils literal notranslate"><span class="pre">d</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.q_to_twotheta">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">q_to_twotheta</code><span class="sig-paren">(</span><em>q</em>, <em>wavelength</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.q_to_twotheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert q to two-theta.</p>
<p>By definition the relationship is:</p>
<div class="math notranslate nohighlight">
\[\sin\left(\frac{2\theta}{2}\right) = \frac{\lambda q}{4 \pi}\]</div>
<p>thus</p>
<div class="math notranslate nohighlight">
\[2\theta_n = 2 \arcsin\left(\frac{\lambda q}{4 \pi}\right)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of <span class="math notranslate nohighlight">\(q\)</span> values</p>
</dd>
<dt><strong>wavelength</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Wavelength of the incoming x-rays</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>two_theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of <span class="math notranslate nohighlight">\(2\theta\)</span> values in radians</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.twotheta_to_q">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">twotheta_to_q</code><span class="sig-paren">(</span><em>two_theta</em>, <em>wavelength</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.twotheta_to_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert two-theta to q</p>
<p>By definition the relationship is</p>
<div class="math notranslate nohighlight">
\[\sin\left(\frac{2\theta}{2}\right) = \frac{\lambda q}{4 \pi}\]</div>
<p>thus</p>
<div class="math notranslate nohighlight">
\[q = \frac{4 \pi \sin\left(\frac{2\theta}{2}\right)}{\lambda}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>two_theta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of <span class="math notranslate nohighlight">\(2\theta\)</span> values</p>
</dd>
<dt><strong>wavelength</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Wavelength of the incoming x-rays</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>q</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">An array of <span class="math notranslate nohighlight">\(q\)</span> values in the inverse of the units
of <code class="docutils literal notranslate"><span class="pre">wavelength</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.angle_grid">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">angle_grid</code><span class="sig-paren">(</span><em>center</em>, <em>shape</em>, <em>pixel_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.angle_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a grid of angular positions.</p>
<p>Read note for our conventions here – there be dragons!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">point in image where r=0; may be a float giving subpixel precision.
Order is (rr, cc).</p>
</dd>
<dt><strong>shape: tuple</strong></dt>
<dd><p class="first last">Image shape which is used to determine the maximum extent of output
pixel coordinates. Order is (rr, cc).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>agrid</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">angular position (in radians) of each array element in range [-pi, pi]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.radial_grid">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">radial_grid</code><span class="sig-paren">(</span><em>center</em>, <em>shape</em>, <em>pixel_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.radial_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a cartesian grid (x,y) to the radius relative to some center</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">point in image where r=0; may be a float giving subpixel precision.
Order is (rr, cc).</p>
</dd>
<dt><strong>shape</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">Image shape which is used to determine the maximum extent of output
pixel coordinates.
Order is (rr, cc).</p>
</dd>
<dt><strong>pixel_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sequence, optional</span></dt>
<dd><p class="first last">The physical size of the pixels.
len(pixel_size) should be the same as len(shape)
defaults to (1,1)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>r</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">The distance of each pixel from <cite>center</cite>
Shape of the return value is equal to the <cite>shape</cite> input parameter</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.refine_center">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">refine_center</code><span class="sig-paren">(</span><em>image</em>, <em>calibrated_center</em>, <em>pixel_size</em>, <em>phi_steps</em>, <em>max_peaks</em>, <em>thresh</em>, <em>window_size</em>, <em>nx=None</em>, <em>min_x=None</em>, <em>max_x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.refine_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Refines the location of the center of the beam.</p>
<p>This relies on being able to see the whole powder pattern.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">The image</p>
</dd>
<dt><strong>calibrated_center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">(row, column) the estimated center</p>
</dd>
<dt><strong>pixel_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">(pixel_height, pixel_width)</p>
</dd>
<dt><strong>phi_steps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">How many regions to split the ring into, should be &gt;10</p>
</dd>
<dt><strong>max_peaks</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of rings to look it</p>
</dd>
<dt><strong>thresh</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Fraction of maximum peak height</p>
</dd>
<dt><strong>window_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">The window size to use (in bins) to use when refining peaks</p>
</dd>
<dt><strong>nx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of bins to use for radial binning</p>
</dd>
<dt><strong>min_x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The minimum radius to use for radial binning</p>
</dd>
<dt><strong>max_x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The maximum radius to use for radial binning</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>calibrated_center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">The refined calibrated center.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="skbeam.diffraction.estimate_d_blind">
<code class="descclassname">skbeam.diffraction.</code><code class="descname">estimate_d_blind</code><span class="sig-paren">(</span><em>name</em>, <em>wavelength</em>, <em>bin_centers</em>, <em>ring_average</em>, <em>window_size</em>, <em>max_peak_count</em>, <em>thresh</em><span class="sig-paren">)</span><a class="headerlink" href="#skbeam.diffraction.estimate_d_blind" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the sample-detector distance</p>
<p>Given a radially integrated calibration image return an estimate for
the sample-detector distance.  This function does not require a
rough estimate of what d should be.</p>
<p>For the peaks found the detector-sample distance is estimated via</p>
<div class="math notranslate nohighlight">
\[D = \frac{r}{\tan 2\theta}\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the distance in mm from the calibrated center
to the ring on the detector and <span class="math notranslate nohighlight">\(D\)</span> is the distance from
the sample to the detector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">The name of the calibration standard.  Used to look up the
expected peak location</p>
<p class="last">Valid options: [‘Al2O3’, ‘CeO2’, ‘LaB6’, ‘Ni’, ‘Si’]</p>
</dd>
<dt><strong>wavelength</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The wavelength of scattered x-ray in nm</p>
</dd>
<dt><strong>bin_centers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">The distance from the calibrated center to the center of
the ring’s annulus in mm</p>
</dd>
<dt><strong>ring_average</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">The average intensity in the given ring of a azimuthally integrated
powder pattern.  In counts [arb]</p>
</dd>
<dt><strong>window_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of elements on either side of a local maximum to
use for locating and refining peaks.  Candidates are identified
as a relative maximum in a window sized (2*window_size + 1) and
the same window is used for fitting the peaks to refine the location.</p>
</dd>
<dt><strong>max_peak_count</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Use at most this many peaks</p>
</dd>
<dt><strong>thresh</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Fraction of maximum peak height</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dist_sample</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The detector-sample distance in mm.  This is the mean of the estimate
from all of the peaks used.</p>
</dd>
<dt><strong>std_dist_sample</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The standard deviation of d computed from the peaks used.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">scikit-beam</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started with Scikit-beam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installing scikit-beam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#updating-your-installation">Updating Your Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Complete Reference (API)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#core">Core</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#domain-name-spaces">Domain name spaces</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">diffraction</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="fluorescence.html"><code class="docutils literal notranslate"><span class="pre">fluorescence</span></code> Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/workflow/get_devel_version.html">Try the development version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/workflow/development_workflow.html">How to make a code contribution</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Project organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/workflow/development_workflow.html">How to make a code contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/codeguide.html">Coding Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/docguide.html">Writing Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/testguide.html">Testing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/scripts.html">Writing Command-Line Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/building.html">Building Scikit-beam and its Subpackages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/ccython.html">C or Cython Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/releasing.html">Release Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/workflow/maintainer_workflow.html">Workflow for Maintainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/affiliated-packages.html">How to create and maintain an Skbeam affiliated package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/vision.html">Vision for a Common Python Package for x-ray, electron and neutrons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_changes.html">API Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_versions.html">Supported versions of Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../warnings.html">Python warnings system</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../whatsnew/index.html">Major Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../known_issues.html">Known Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Example gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction to scikit-beam</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Complete Reference (API)</a><ul>
      <li>Previous: <a href="core/mask.html" title="previous chapter"><code class="docutils literal notranslate"><span class="pre">core.mask</span></code> Module</a></li>
      <li>Next: <a href="fluorescence.html" title="next chapter"><code class="docutils literal notranslate"><span class="pre">fluorescence</span></code> Module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014-2015 Brookhaven National Lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../_sources/resource/api/diffraction.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>